<!doctype html>
<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"
        integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA=="
        crossorigin="anonymous">
        </script>
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col-lg-8  offset-lg-2">
                <h2 class="mt-5">Not so Lucky Imaging APP</h2>
                <form method="post" action="{{ url_for('gui_task') }}">
                    <input type="submit" value="Start/Stop Recording" name="recording" />
                    <div>
                        <input type="range" id="gain" name="gain" , min="1" max="31">
                        <label for="gain">Gain</label>
                        <input type="range" id="exposure" name="exposure" , min="500" max="7300000">
                        <label for="exposure">Exposure Time</label> <output id="exposure_output">100 µs</output>
                        <input type="submit" value="Change Settings" name="setup" />

                        <script>
                            var socket = io()
                            socket.on('connect', function () {
                                socket.emit('my event', { data: 'I\'m connected!' });
                            });

                            const exposure_output = document.querySelector("#exposure_output")
                            const input = document.querySelector("#exposure")
                            exposure_output.textContent = input.value
                            input.addEventListener("input", (event) => {
                                exposure_output.textContent = event.target.value + " µs"
                                socket.emit('slider_exposure', { value: event.target.value });
                                socket.emit('message', { value: event.target.value });
                            })
                        </script>
                    </div>

                </form>
                <img src="{{ url_for('live_feed') }}" height="50%">
            </div>
        </div>
    </div>
</body>

</html>